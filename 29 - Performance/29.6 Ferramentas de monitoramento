üõ†Ô∏è Ferramentas de Monitoramento no PostgreSQL
üìå Por que monitorar o banco de dados?
Para saber como est√° o desempenho do banco.

Para identificar problemas antes que fiquem graves.

Para analisar o uso de recursos, como mem√≥ria, disco e CPU.

Para entender quais consultas est√£o lentas ou travando o sistema.

üîé Monitoramento b√°sico com comandos SQL
1. Ver conex√µes ativas
sql
Copy
Edit
SELECT * FROM pg_stat_activity;
Mostra todas as conex√µes ativas no momento.

Voc√™ v√™:

Qual usu√°rio est√° conectado.

Qual consulta est√° rodando.

H√° quanto tempo ela est√° em execu√ß√£o.

2. Ver estat√≠sticas gerais das tabelas
sql
Copy
Edit
SELECT * FROM pg_stat_user_tables;
Mostra:

Quantas vezes cada tabela foi lida ou escrita.

Quantos updates, inserts e deletes foram feitos.

3. Ver √≠ndices e seu uso
sql
Copy
Edit
SELECT * FROM pg_stat_user_indexes;
Indica se os √≠ndices est√£o sendo usados ou est√£o ‚Äúparados‚Äù.

√çndices sem uso podem ser removidos para melhorar a performance.

4. Ver uso de disco por tabela
sql
Copy
Edit
SELECT relname AS tabela,
       pg_size_pretty(pg_total_relation_size(relid)) AS tamanho
FROM pg_catalog.pg_statio_user_tables
ORDER BY pg_total_relation_size(relid) DESC;
Mostra quais tabelas est√£o ocupando mais espa√ßo no disco.

5. Ver consultas lentas em execu√ß√£o
sql
Copy
Edit
SELECT pid, now() - query_start AS duracao, query
FROM pg_stat_activity
WHERE state = 'active'
ORDER BY duracao DESC;
√ötil para encontrar consultas que est√£o rodando h√° muito tempo.

üñ•Ô∏è Ferramentas gr√°ficas para monitorar PostgreSQL
1. pgAdmin
Ferramenta oficial de administra√ß√£o do PostgreSQL.

Mostra:

Conex√µes, consultas ativas, estat√≠sticas.

Gr√°ficos simples de uso de disco e √≠ndices.

F√°cil de usar, ideal para iniciantes.

2. PgHero
Interface web muito amig√°vel.

Mostra:

Consultas lentas.

√çndices ineficientes.

Conex√µes e cache.

Muito usada para diagn√≥sticos r√°pidos.

3. pg_stat_statements
Extens√£o oficial do PostgreSQL.

Armazena estat√≠sticas detalhadas das consultas.

Mostra:

Quais s√£o as consultas mais executadas.

Tempo m√©dio de execu√ß√£o.

Quantidade de leituras e escritas.

Como ativar:
No arquivo postgresql.conf, adicione:

ini
Copy
Edit
shared_preload_libraries = 'pg_stat_statements'
Depois:

sql
Copy
Edit
CREATE EXTENSION pg_stat_statements;
E para consultar:

sql
Copy
Edit
SELECT * FROM pg_stat_statements ORDER BY total_time DESC LIMIT 10;
4. Prometheus + Grafana (para ambientes mais avan√ßados)
Prometheus coleta dados.

Grafana exibe em gr√°ficos interativos e bonitos.

Usado em empresas e servidores com muitos bancos em produ√ß√£o.

‚úÖ Resumo
Monitorar o banco √© essencial para garantir boa performance e estabilidade.

O PostgreSQL tem ferramentas internas e gr√°ficas para isso.

Comece com pg_stat_activity, pg_stat_user_tables e o pgAdmin.

Com o tempo, explore pg_stat_statements, PgHero e at√© Grafana.

Monitoramento √© o que previne problemas, n√£o s√≥ o que resolve.

