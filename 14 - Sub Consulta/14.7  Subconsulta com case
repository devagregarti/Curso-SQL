ğŸ¯ TÃ³pico: Subconsulta com CASE â€“ usar lÃ³gica condicional dentro de consultas aninhadas
âœ… Objetivo:
Mostrar como combinar subconsultas com a estrutura CASE para criar resultados dinÃ¢micos e categorizados conforme condiÃ§Ãµes especÃ­ficas.

ğŸ§© 1. O que Ã©?
ğŸ“Œ O CASE funciona como um â€œif-then-elseâ€ dentro do SQL, permitindo criar colunas que mudam conforme valores ou condiÃ§Ãµes.
ğŸ“Œ Quando usado junto com subconsulta, vocÃª pode aplicar essa lÃ³gica a valores derivados de outra consulta.

ğŸ” 2. Exemplo prÃ¡tico:
Queremos listar clientes e classificar o valor do maior pedido deles em categorias:

Alto (maior que 1000),

MÃ©dio (entre 500 e 1000),

Baixo (menos que 500).

sql
Copy
Edit
SELECT 
  c.nome,
  CASE
    WHEN (SELECT MAX(p.valor) FROM pedidos p WHERE p.cliente_id = c.id) > 1000 THEN 'Alto'
    WHEN (SELECT MAX(p.valor) FROM pedidos p WHERE p.cliente_id = c.id) BETWEEN 500 AND 1000 THEN 'MÃ©dio'
    ELSE 'Baixo'
  END AS categoria_pedido
FROM clientes c;
ğŸ” 3. Como funciona:
Para cada cliente, a subconsulta pega o maior pedido.

O CASE avalia esse valor e classifica numa categoria.

Resultado prÃ¡tico para anÃ¡lise rÃ¡pida dos clientes.

ğŸ“ 4. Dica para slide/roteiro:
â€œCombinar subconsulta e CASE permite criar relatÃ³rios dinÃ¢micos e categorizados, facilitando a interpretaÃ§Ã£o de dados complexos de forma simples e rÃ¡pida.â€