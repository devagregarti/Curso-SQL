ğŸ” 1. Entenda como a aplicaÃ§Ã£o usa os dados
Quais sÃ£o as consultas mais comuns?

Filtros (WHERE)

JunÃ§Ãµes (JOIN ON)

OrdenaÃ§Ãµes (ORDER BY)

Agrupamentos (GROUP BY)

Quais colunas aparecem com mais frequÃªncia nesses comandos?

ğŸ§  Exemplo real:
Se os usuÃ¡rios da aplicaÃ§Ã£o sempre buscam clientes pelo nome ou email:

sql
Copy
Edit
SELECT * FROM clientes WHERE nome ILIKE 'joÃ£o%' OR email = 'joao@email.com';
â†’ Essas colunas sÃ£o boas candidatas a Ã­ndices.

ğŸ“Š 2. Verifique o volume da tabela
Tabelas pequenas (centenas de linhas) nÃ£o precisam de Ã­ndice.

Tabelas mÃ©dias e grandes (milhares ou milhÃµes) podem se beneficiar muito.

ğŸ“Œ Dica:

sql
Copy
Edit
SELECT relname AS tabela, n_live_tup AS linhas
FROM pg_stat_user_tables
ORDER BY n_live_tup DESC;
ğŸ“ˆ 3. Verifique a seletividade da coluna
Quanto mais distintos os valores, melhor o Ã­ndice funciona.

Ãndices sÃ£o mais Ãºteis em colunas como: email, cpf, id, etc.

SÃ£o menos Ãºteis em colunas como ativo, status, sexo, etc.

ğŸ“Œ Dica para ver a seletividade:

sql
Copy
Edit
SELECT COUNT(DISTINCT status), COUNT(*) FROM pedidos;
Se tiver 1 milhÃ£o de linhas e sÃ³ 3 valores distintos, nÃ£o vale a pena indexar status.

ğŸ”„ 4. A coluna Ã© frequentemente atualizada?
Colunas que mudam com frequÃªncia tornam o Ã­ndice um peso (custo de manutenÃ§Ã£o).

Evite indexar colunas com muitos UPDATEs.

ğŸ§  Exemplo ruim:

sql
Copy
Edit
UPDATE pedidos SET status = 'entregue';
Se status estiver indexado, isso afeta milhares de entradas no Ã­ndice.

ğŸ“… 5. A coluna cresce de forma ordenada? (para BRIN)
Colunas como data_criacao, id_serial, data_evento sÃ£o ideais para BRIN.

Muito Ãºtil em tabelas de log, histÃ³rico, auditoria, etc.

ğŸ›  6. Use o plano de execuÃ§Ã£o para avaliar a necessidade real
Rode a consulta com EXPLAIN ANALYZE e veja se estÃ¡ usando seq scan ou index scan.

ğŸ“Œ Exemplo:

sql
Copy
Edit
EXPLAIN ANALYZE
SELECT * FROM vendas WHERE cliente_id = 123;
Se mostrar Seq Scan, talvez precise de Ã­ndice em cliente_id.

ğŸ§¹ 7. Use Ã­ndices parciais para evitar excesso de manutenÃ§Ã£o
Quando a maioria dos dados nÃ£o interessa nas consultas, um Ã­ndice parcial reduz espaÃ§o e custo.

ğŸ§  Exemplo:

sql
Copy
Edit
CREATE INDEX idx_pedidos_ativos ON pedidos (status)
WHERE status = 'ativo';


ğŸ“Œ Checklist final para decidir se vale a pena criar um Ã­ndice


| CritÃ©rio                                         | EstÃ¡ presente? |
| ------------------------------------------------ | -------------- |
| A coluna Ã© usada em `WHERE`, `JOIN`, `ORDER BY`? | âœ… ou âŒ      |
| A tabela tem milhares ou milhÃµes de linhas?      | âœ… ou âŒ      |
| A coluna tem muitos valores distintos?           | âœ… ou âŒ      |
| A coluna muda pouco?                             | âœ… ou âŒ      |
| O `EXPLAIN ANALYZE` mostra `Seq Scan`?           | âœ… ou âŒ      |

