Aula: Exemplo com Particionamento por LISTA (LIST) no PostgreSQL
‚úÖ O que √© particionamento por LISTA?
√â quando a tabela √© dividida em partes (parti√ß√µes) com base em valores espec√≠ficos.

Diferente do particionamento por faixa (RANGE), aqui voc√™ define os valores exatos que v√£o em cada parti√ß√£o.

üß† Quando usar?
Quando os dados podem ser agrupados por uma categoria ou valor fixo.

Exemplo: por estado, por tipo de produto, por status (ativo/inativo), por categoria, etc.

üß± Exemplo pr√°tico: pedidos por estado
Vamos guardar pedidos feitos em diferentes estados do Brasil.

1. Criando a tabela principal (particionada por LISTA)
sql
Copy
Edit
CREATE TABLE pedidos (
  id SERIAL PRIMARY KEY,
  cliente TEXT NOT NULL,
  estado TEXT NOT NULL
) PARTITION BY LIST (estado);
Explicando:

Estamos dizendo que a parti√ß√£o ser√° feita com base no valor da coluna estado.

Cada parti√ß√£o ter√° estados espec√≠ficos (por exemplo, SP, RJ, MG...).

2. Criando as parti√ß√µes
sql
Copy
Edit
CREATE TABLE pedidos_sp PARTITION OF pedidos
FOR VALUES IN ('SP');

CREATE TABLE pedidos_rj PARTITION OF pedidos
FOR VALUES IN ('RJ');

CREATE TABLE pedidos_mg PARTITION OF pedidos
FOR VALUES IN ('MG');
Observa√ß√µes:

Cada parti√ß√£o aceita apenas os valores definidos.

Se tentar inserir um estado diferente, vai dar erro (a menos que exista uma parti√ß√£o DEFAULT).

3. (Opcional) Criar parti√ß√£o DEFAULT
sql
Copy
Edit
CREATE TABLE pedidos_outros PARTITION OF pedidos DEFAULT;
Serve para receber os pedidos de estados que n√£o est√£o nas parti√ß√µes principais.

‚úçÔ∏è Inserindo dados
sql
Copy
Edit
INSERT INTO pedidos (cliente, estado) VALUES
('Jo√£o', 'SP'),
('Maria', 'RJ'),
('Carlos', 'MG'),
('Fernanda', 'BA');  -- Vai para a parti√ß√£o DEFAULT
üîç Consultando os dados
Consulta normal:

sql
Copy
Edit
SELECT * FROM pedidos;
Consulta com filtro:

sql
Copy
Edit
SELECT * FROM pedidos WHERE estado = 'SP';
Consulta por parti√ß√£o (opcional):

sql
Copy
Edit
SELECT * FROM pedidos_sp;
üß™ Verificando onde cada dado foi parar
sql
Copy
Edit
SELECT * FROM pedidos_rj;
-- Deve retornar apenas a Maria

SELECT * FROM pedidos_outros;
-- Deve retornar a Fernanda (estado BA)
‚ö†Ô∏è Cuidados
N√£o pode repetir o mesmo valor em duas parti√ß√µes.

O valor do campo usado (neste caso, estado) precisa existir na parti√ß√£o correta.

Sem a parti√ß√£o DEFAULT, valores fora das listas definidas causam erro na inser√ß√£o.

üìå Quando usar LIST em vez de RANGE?
Use LIST quando:

Os valores s√£o fixos e bem definidos.

Voc√™ n√£o precisa de intervalos (como datas ou n√∫meros).

Ex: estados, tipos, categorias, status.

üîö Conclus√£o
O particionamento por LISTA √© simples e muito √∫til para categorias com valores definidos.

Ajuda a organizar melhor os dados e facilita buscas por grupos espec√≠ficos.

O PostgreSQL cuida de colocar cada registro na parti√ß√£o correta, desde que as regras estejam bem definidas.

